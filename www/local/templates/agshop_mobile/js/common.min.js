$(function(){function e(){$("body").css("min-height",innerHeight),$(".mobile-header-category").css("top",-1*innerHeight),$(".mobile-aside-filter").css("min-height",i),$(".mobile-aside-form-inner").css("min-height",innerHeight-33),$(".mobile-aside-dropdown-outer").css("min-height",innerHeight),$(".mobile-search-notfind").css("height",innerHeight-59),$(".mobile-search-status").css("max-height",innerHeight-59)}function o(){var o=null!=window.orientation?0!=window.orientation:window.innerWidth>window.innerHeight;a.toggleClass("landscape",o),i=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight),e()}function t(){$(".mobile-aside-dropdown-content").each(function(e,o){var t=$(this).attr("data-dropdown"),i=$(this).children(),a=$(".mobile-aside-form-item__option").find("[data-dropdown='"+t+"']"),n=[];$(i).each(function(e,o){var t=$(this).find("input"),i=$(this).find(".custom-checkbox-default__info-title");t.prop("checked")&&n.push(i.text())}),a.empty();for(var s=0;s<n.length;s++)a.append("<span class='mobile-aside-dropdown__item'>"+n[s]+"</span>")})}var i=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight);e(),window.onorientationchange?window.onorientationchange=o:window.onresize=o;var a=$(document.body);o(),$(".mobile-header").headroom({offset:20,tolerance:5}),$(".mobile-aside-filter-outer").on("click",function(){$(".mobile-aside-dropdown-outer").hasClass("show-dropdown")?$(".mobile-aside-dropdown-outer").removeClass("show-dropdown"):($("body").removeClass("noscroll"),$(".mobile-aside-filter").removeClass("show-filters"))}),$(".mobile-header-caregory-btn").on("click",function(){$("body").toggleClass("noscroll white-background"),$(".typeahead").typeahead("val",""),$(".mobile-header-search__clear").removeClass("show-clear"),$(this).toggleClass("active"),$(".mobile-header-category").toggleClass("show-category")}),$(".mobile-header-filter-btn").on("click",function(){$("body").addClass("noscroll"),$("body").removeClass("white-background"),$(".mobile-header-category").removeClass("show-category"),$(".mobile-header-caregory-btn").removeClass("active"),$(".typeahead").typeahead("val",""),$(".mobile-header-search__clear").removeClass("show-clear"),$(".mobile-aside-filter").addClass("show-filters")}),$(".mobile-aside-dropdown").on("click",function(){$(this).parent().hasClass("disabled")||$(this).next().addClass("show-dropdown")}),$(".dropdown-close").on("click",function(){$(".mobile-aside-dropdown-outer").removeClass("show-dropdown")}),$(".dropdown-save").on("click",function(){var e=$(this).attr("data-dropdown"),o=$(".mobile-aside-dropdown-outer").find("[data-dropdown='"+e+"']").children(),t=[],i=$(".mobile-aside-form-item__option").find("[data-dropdown='"+e+"']");$(o).each(function(e,o){var i=$(this).find("input"),a=$(this).find(".custom-checkbox-default__info-title");i.prop("checked")&&t.push(a.text())}),i.empty();for(var a=0;a<t.length;a++)i.append("<span class='mobile-aside-dropdown__item'>"+t[a]+"</span>");$(".mobile-aside-dropdown-outer").removeClass("show-dropdown")}),t(),$("#mobileFiltersReset").on("click",function(e){e.preventDefault(),$("#mobileAsideFilterForm")[0].reset(),t()}),$(".default-dropdown-label").on("click",function(e){var o=$(this).prev(),t=$(this).parents(".mobile-aside-dropdown-content"),i=t.children(),a=$(t).find(".dropdown-checkbox-all");o.hasClass("dropdown-checkbox-all")?(e.preventDefault(),o.prop("checked")?o.prop("checked",!1):($(i).each(function(e,o){$(this).find("input").prop("checked",!1)}),o.prop("checked",!0))):a.prop("checked",!1)});var n=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("category"),queryTokenizer:Bloodhound.tokenizers.whitespace,prefetch:"../json/category.json"}),s=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("item"),queryTokenizer:Bloodhound.tokenizers.whitespace,prefetch:"../json/product-items.json"});$("#multiple-datasets .typeahead").typeahead({highlight:!0,menu:$(".mobile-search-status")},{name:"product-items",display:"item",source:s,templates:{header:'<h3 class="mobile-header-search__title">По наименованию</h3>'}},{name:"category",display:"category",source:n,templates:{header:'<h3 class="mobile-header-search__title">По фильтрам</h3>'}}),$("#multiple-datasets .tt-input").focus(function(){$(".mobile-header-search__clear").addClass("show-clear"),$(".mobile-search-status").addClass("show-results")}),$("#multiple-datasets .tt-input").blur(function(){$(this).val()||($(".mobile-header-search__clear").removeClass("show-clear"),$(".mobile-search-status").removeClass("show-results"))}),$(".mobile-header-search__clear").on("click",function(){$(".typeahead").typeahead("val",""),$(".mobile-header-search__clear").removeClass("show-clear"),1!=$("body").hasClass("noscroll white-background")&&$("body").removeClass("noscroll")}),$("#multiple-datasets .tt-input").bind("typeahead:select",function(e,o){$("#mobileHeaderSearchForm")[0].submit()}),$("#multiple-datasets .tt-input").bind("typeahead:autocomplete",function(e,o){$("#mobileHeaderSearchForm")[0].submit()}),$("#multiple-datasets .tt-input").bind("typeahead:render",function(e,o){1!=$("body").hasClass("noscroll")&&$("body").addClass("noscroll")})});