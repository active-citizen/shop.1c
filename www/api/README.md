Score convertion controller
===

# API 

## Структура запроса

- URL запроса: **/api/index.php** 
- Тип запроса: **POST**
- Вид запроса: строка **JSON**, переданная в *POST*-переменной **request**

## Методы

### auth. Авторизация.
#### Запрос

```
{
    "method":"auth",
    "args":{
        "login":"79277374026",
        "password":"*************"
    }
}
 ```
- **login** - номер телефона пользователя АГ

#### Ответ

```
{
    "errorCode":0,
    "errorMessage":"",
    "result":{
        "session_id":"********************************"
    }
}
```

- *session_id* после этого используется в других методах для авторизации запроса





### points.  Получение истории баллов
#### Запрос
```
{
    "method":"points",
    "args":{
    },
    "session_id":"***********************************"
}        
 
```
- *session_id* - ID сессии, полученный полсе выполнения методаа *auth* либо от
  другой информационной системы

#### Ответ
```
{
    "errorCode":0,
    "errorMessage":"",
    "result":{
        "history":[
            {
                "date":"1490075843",
                "points":"3.000",
                "title":"Активное участие",
                "action":"debit",
                "ctime":"2017-03-21 09:57:23",
                "ctimef":"21.03.2017 09:57:23",
                "quantity":"3.00",
                "debit":"1.000",
                "accepted":"1",
                "crc32":"455970575"
            },
            {
                "date":"1490005327",
                "points":"3.000",
                "title":"Активное участие",
                "action":"debit",
                "ctime":"2017-03-20 14:22:07",
                "ctimef":"20.03.2017 14:22:07",
                "quantity":"3.00",
                "debit":"1.000",
                "accepted":"1",
                "crc32":"3481405"
            },
            ...
        ]
    }
}
```

### transaction. Начисление/списание баллов
#### Запрос на снятие 10 баллов

```
{
    "method":"transaction",
    "args":{
        "appId":"1",
        "points":"10",
        "debit": "-1",
        "comment": "Снятие 10 баллов"
    },
    "session_id":"******************************"
}

```
#### Запрос на начисление 10000 баллов

```
{
    "method":"transaction",
    "args":{
        "appId":"1",
        "points":"10000",
        "debit": "1",
        "comment": "Победа в конкурсе ТЕСТЕР ГОДА"
    },
    "session_id":"******************************"
}

```
- *session_id* - ID сессии, полученный полсе выполнения методаа *auth* либо от
  другой информационной системы
- appId - id приложения, которое снимает или начисляет баллы 1-это Магазин
  поощрений Битрикс
- *points* - количество баллов
- *debit* - направление движения средств -1 --- снятие, 1 --- начисление
- *comment* - комментарий к транзакции


#### Ответ

```
{
    "errorCode":0,
    "errorMessage":"",
    "result":{
        "session_id":"*******************************"
    }
}
```

## Коды ошибок


